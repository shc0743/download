<!DOCTYPE html>
<!-- saved from url=(0058)https://shc7432.github.io/download/apps/smallapp/htmtobat/ -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>HTML/HTA转BAT</title>   
<script src="fullscreen.js"></script>
<script src="shc7432.github.io/public/getLinkInput/getLinkInput.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="background-color:#fff;"><span style="background-color:#fff;">

<h1>HTML转BAT</h1>

<div>
<button onclick="toFullScreen(document.body);">全屏</button><br>
html或hta代码:<br>
<textarea style="width:95%;height:500px;cursor:crosshair;" id="cont" placeholder="请输入"></textarea><br>
Code type: <select id="tppe"><option value="err">Please select a option</option><option value="html">HTML</option><option value="hta">HTA</option></select><br>
<button id="conv" style="width: 100%; cursor: pointer;">Convert</button>  <br>
生成结果:<br><textarea id="resu" style="width:95%;height:500px;cursor:crosshair;" --readonly--=""></textarea><br>
<button onclick="resu.value=&#39;&#39;">Clear</button> <button onclick="window.close()">Exit</button>
</div>

<div id="whitescreen" style="position:absolute;top:0;width:100%;height:1009%;z-index:114514;opacity: 0.75;cursor:wait;background-color:#fff;" hidden="">
<div id="status01" style="position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);border:1px solid;z-index:114519;background-color:#fff;opacity: 551;">请稍候...</div></div>

<script>
function getRandom(min, max){return Math.floor(Math.random() * (max - min + 1) ) + min;}
(function(){
//whitescreen.hidden=0;
window.checkenab=function(){
//whitescreen.style.height=screen.height+23.3+"px";
if(cont.value==""||tppe.value=="err"){
conv.style.cursor='not-allowed'
conv.onmousedown=function(event){event.preventDefault();}
conv.disabled=1;
} else {
conv.style.cursor='pointer'
conv.onmousedown=aa
conv.disabled=0;
} 
window.chktot01=setTimeout(checkenab,100);
}
setTimeout(checkenab,100);
window.aa=function(event){
clearTimeout(chktot01);
event.preventDefault();
//window.style.cursor='wait';
//toFullScreen(document.body);
whitescreen.hidden=0;
var rdmid=getRandom(114514,131454188);
conv.onmousedown=function(event){event.preventDefault();}
var res='',v=cont.value,__temp__;
__temp__=v.split("\n");
res+="@echo off&%systemdrive%&cd %temp%&echo 正在释放...\necho. > temp"+rdmid+"."+tppe.value+"\n";
for(let i=0;i<__temp__.length;i++){
if(__temp__[i]=="") {res+="echo. >> temp"+rdmid+"."+tppe.value+"\n";continue;};
let __temp2__=__temp__[i].replace(/\^/igm,"^^");
// \ / | || && ^ > < *
__temp2__=__temp2__.replace(/\(/igm,"^(");
__temp2__=__temp2__.replace(/\)/igm,"^)");
__temp2__=__temp2__.replace(/\%/igm,"%%");
__temp2__=__temp2__.replace(/\&/igm,"^&");
__temp2__=__temp2__.replace(/\@/igm,"^@");
__temp2__=__temp2__.replace(/\!/igm,"^!");
__temp2__=__temp2__.replace(/\t/igm,"^\t");
__temp2__=__temp2__.replace(/\//igm,"^/");
__temp2__=__temp2__.replace(/\?/igm,"^?");
__temp2__=__temp2__.replace(/\</igm,"^<");
__temp2__=__temp2__.replace(/\>/igm,"^>");
__temp2__=__temp2__.replace(/\*/igm,"^*");
__temp2__=__temp2__.replace(/\\/igm,"^\\");
__temp2__=__temp2__.replace(/\"/igm,"^\"");
__temp2__=__temp2__.replace(/\|/igm,"^|");
res+="echo "+__temp2__+" >> temp"+rdmid+"."+tppe.value+"\n"
}
res+="temp"+rdmid+"."+tppe.value+"\ndel /f /s /q temp"+rdmid+"."+tppe.value+"";
  if(res.length<3000){
setTimeout(function(){
status01.innerHTML="马上就好..."
setTimeout(function(){
resu.value=res;
conv.style.cursor='pointer'
conv.onmousedown=aa;
setTimeout(checkenab,100);
whitescreen.hidden="-1010%";
//unFullScreen();
//window.style.cursor='auto';
status01.innerHTML="Wait..."
},15)
},23.33)
  } else {
setTimeout(function(){
status01.innerHTML="Converting...0%"
setTimeout(function(){
status01.innerHTML="Converting...20%"
setTimeout(function(){
status01.innerHTML="Converting...25%"
setTimeout(function(){
status01.innerHTML="Converting...50%"
setTimeout(function(){
status01.innerHTML="Converting...80%"
setTimeout(function(){
status01.innerHTML="Converting...99%"
setTimeout(function(){
status01.innerHTML="马上就好..."
setTimeout(function(){
resu.value=res;
conv.style.cursor='pointer'
conv.onmousedown=aa;
setTimeout(checkenab,100);
whitescreen.hidden="-1010%";
//unFullScreen();
//window.style.cursor='auto';
status01.innerHTML="请稍候..."
},1500)
},1500)
},2500)
},700)
},1000)
},800)
},1200)
},1800)
  }
}
})()
  function loadjs(a,b,c,d) {
/**
@a src or config
@b config
@c callback
@d error handler
**/
  let script = document.createElement('script');
  script.src = typeof(a)=="string" ? a : typeof(a)==
  "object" ? (a.src||a.href||"PLACEHOLDER") : typeof(
  b)=='object' ? (b.src||b.href||"PLACEHOLDER") : 
  "PLACEHOLDER";
  script.async = typeof(a)==
  "object" ? (a.async||false) : typeof(b)=='object' ?
  (b.async||false) : false;
  //ONLOAD
  script.onload= typeof(a)=='object' ? ((a.callback||
  a.onload||false) ? (a.callback||a.onload) : 
  undefined) : typeof(b)=='object' ? ((b.callback||
  b.onload||false) ? (b.callback||b.onload) : 
  undefined) : typeof(c)=='function' ? c : undefined;
  //ONERROR
  script.onerror= typeof(a)=='object' ? ((a.onerror||
  false) ? a.onerror : undefined) : typeof(b)==
  'object' ? ((b.onerror||false) ? b.onerror : 
  undefined) : typeof(d)=='function' ? d : undefined;
  document.head.appendChild(script);
  return script;
}
setTimeout(function(){
var a=getUrlValue('autoconv');
if(!a){whitescreen.hidden=1;return 1};
cont.value=a;
tppe.value=getUrlValue('type')||'html';
aa({preventDefault:function(){return void 0}});
loadjs("file://c:/windows/temp/htmtobatdata.js");
},Math.floor(500.114514))
</script>
</span>


</body></html>
